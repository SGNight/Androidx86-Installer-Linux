#!/usr/bin/bash

# Shell Script for Android Installer x86 by Supreme-Gamers
# Copyright (C)SupremeGamers 2021
# Must be run as root

osname=$1
path=$2
pid=$3
grubconfig="/etc/grub.d/40_custom"



script_home="#!/usr/bin/bash

# Script Generated by Androidx86Installer


if [[ \`whoami\` != 'root' ]];then
  echo 'Run as root to Uninstall'
else
  echo 'Uninstalling : $osname '
  echo 'Removing GRUB Entry'
  grep -v '# ${pid} - ax86-installer' $grubconfig > tmpfile && mv tmpfile $grubconfig
  update-grub
  echo 'Removing Files'

  if [[ -d '${path}/data' ]];then
  chattr -R -i '${path}/data'
  fi

  rm '${path}/' -r

  echo 'Successfully Uninstalled $osname'
fi"

script_norm="#!/usr/bin/bash

# Script Generated by Androidx86Installer

if [[ \`whoami\` != 'root' ]];then
  echo 'Run as root to Uninstall'
else
  echo 'Uninstalling : $osname '
  echo 'Removing GRUB Entry'
  grep -v '# ${pid} - ax86-installer' $grubconfig > tmpfile && mv tmpfile $grubconfig
  update-grub

  if [[ \`dirname \"\$0\"\` != '.' ]];then
      folder=\`dirname \"\$0\"\`
   else
	    folder=\`pwd\`
  fi


  echo 'Removing Files'
  if [[ -d \"\${folder}/data\" ]];then

  chattr -R -i \"\${folder}/data\"

  fi

  rm \"\${folder}/\" -r

  echo 'Successfully Uninstalled $osname'

fi"

if [[ $4 != "home" ]];then
  echo "${script_norm}" > "${path}/uninstall.sh"
else
  echo "${script_home}" > "${path}/uninstall.sh"
fi

chmod 755 "${path}/uninstall.sh"
